## 汇编命令

> 讲解各个指令的含义

- **在nasm中，任何不被方括号[]括起来的标签或者变量名都被认为是地址，访问标签中的内容必须用[]。**

- $ 表示汇编后当前行的位置，$$ 代表当前节（section）的开始被汇编的地址。$-$$表示本行距离开始处的相对距离。
- ;   注释
- LEA 是取内存地址指令

```bash
LEA DX,hello #这里hello为数据，LEA取出hello在内存中的首地址，并赋值给DX寄存器
```

- ORG 在程序执行的时候，会告诉编译器将这些指令转载到内存的哪个位置。 $(美元符)代表将要读入的内存地址。
- JMP  类似于C中的 go to， 跳转
- entry  用于指定JMP 指令的跳转目的地
- DB  : data byte的缩写，向文件中直接写入一个字节的指令
- DW ： data word，写入一个字，两个字节
- DD ： data double-word，两个字，4个字节
- RESB ： “reserve byte”的缩写，把指定的地址空出来
- MOV ：这个指令非常重要，理解了它，就理解了汇编的一大半。

```bash
MOV AX,0    #相当于 AX=0；
MOV	SI,msg   # 这个例子中，msg是下面出现的标号。在汇编语言中，所有标号都仅仅是单纯的数字。每个标号对应的数字,是由汇编语言编译器根据ORG指令计算出来的。编译器计算出的“标号的地方对应的内存地址”就是那个标号的值。
MOV BYTE [678],123  #加上中括号，代表内存中的地址，因此这个指令的含义是 将123赋值给内存地址为678的位置,占用一字节。如果BYTE为WORD，则占用两字节。
```

- ADD ： ADD S1,1  表示 S1=S1+1
- CMP： compare的缩写，比较指令。
- JE： 条件跳转指令之一。

```bash
CMP AL,0
JE fin
#这两条指令相当于
if (Al==0){
 goto fin
}
```

- INT : Interrupt的缩写 。中断指令，用来调用BIOS中函数的指令。
- HLT ： halt的缩写，意思为停止。作用：让CPU进入待机状态，只要外部发生变化，CPU就会醒过来。
- JC ： "jump if carry " ，意思是如果进位标志为1的话，就跳转。INF调用函数后，没有错，进位标志为0，有错，进位标志为1.
- JNC ： “jump if not carry”。进位为0就跳转。
- JAE： “jump if  above or equal”  大于等于时跳转。
- JBE： “jump if below or equal” 小于等于则跳转。
- RET： 相当于C中的return

```bash
; hello-os
; TAB=4

		ORG		0x7c00			; 指明程序装载地址

; 标准FAT12格式软盘专用的代码 Stand FAT12 format floppy code

		JMP		entry
		DB		0xeb, 0x4e, 0x90
		
; 程序主体

entry:
		MOV		AX,0			; 初始化寄存器
		MOV		SS,AX
		MOV		SP,0x7c00
		MOV		DS,AX
		MOV		ES,AX

		MOV		SI,msg
putloop:
		MOV		AL,[SI]
		ADD		SI,1			; 给SI加1
		CMP		AL,0
		JE		fin
		MOV		AH,0x0e			; 显示一个文字
		MOV		BX,15			; 指定字符颜色
		INT		0x10			; 调用显卡BIOS
		JMP		putloop
fin:
		HLT						; 让CPU停止，等待指令
		JMP		fin				; 无限循环

msg:
		DB		0x0a, 0x0a		; 换行两次
		DB		"hello, world"
		DB		0x0a			; 换行
		DB		0

		RESB	0x7dfe-$		; 填写0x00直到0x001fe

		DB		0x55, 0xaa
```

> 寄存器

- 除此之外还有其他寄存器，请自行百度。

| 寄存器 | 含义           |
| ------ | -------------- |
| AX     | 累加寄存器     |
| CX     | 计数寄存器     |
| DX     | 数据寄存器     |
| BX     | 基址寄存器     |
| SP     | 栈指针寄存器   |
| BP     | 基址指针寄存器 |
| SI     | 源变址寄存器   |
| DI     | 目的变址寄存器 |

